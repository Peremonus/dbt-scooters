SELECT
    -- Дата начала поездки (приводим timestamp к дате)
    -- DATE(started_at) извлекает только дату из временной метки
    DATE(started_at) AS date,
    
    -- Количество поездок за день
    -- COUNT(*) подсчитывает все поездки, сгруппированные по дате
    COUNT(*) AS trips,
    
    -- Максимальная стоимость поездки за день в рублях
    -- MAX(price) находит наибольшее значение цены для каждой даты
    MAX(price) AS max_price_rub,
    
    -- Средняя дальность поездки за день в километрах
    -- AVG(distance) вычисляет среднее арифметическое расстояния
    -- ROUND(..., 2) округляет результат до 2 десятичных знаков
    -- Предполагается, что distance хранится в километрах
    ROUND(AVG(distance)::numeric, 2) AS avg_distance_km

-- Указываем таблицу с данными о поездках
FROM scooters_raw.trips

-- Группируем результаты по дате начала поездки
-- Все агрегирующие функции (COUNT, MAX, AVG) работают в рамках каждой группы
GROUP BY DATE(started_at)

-- Сортируем результаты по дате в хронологическом порядке
-- ORDER BY гарантирует, что строки вернутся отсортированными от самой ранней к самой поздней дате
ORDER BY date