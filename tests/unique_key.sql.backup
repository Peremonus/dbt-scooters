{% test unique_key(model, column_name) %}
{% set column_list = column_name if column_name is iterable and column_name is not string else [column_name] %}

with validation_errors as (
    select
        {% for column in column_list %}
        {{ column }}{% if not loop.last %},{% endif %}
        {% endfor %}
    from {{ model }}
    group by {% for column in column_list %}{{ column }}{% if not loop.last %},{% endif %}{% endfor %}
    having count(*) > 1
)

select * from validation_errors
{% endtest %}